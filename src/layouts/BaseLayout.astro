---
import '../styles/global.css';
import '../styles/cls-guards.css';
import '../styles/fonts.css';
import UnifiedSchema from '@/components/SEO/UnifiedSchema.astro';
import LCPPreload from '@/components/LCPPreload.astro';
import DeferNonCritical from '@/components/DeferNonCritical.astro';

export interface Props {
  title: string;
  pageType?: 'service' | 'city' | 'corridor' | 'blog' | 'home';
  service?: { name: string; description?: string; areaServed?: string[] };
  faqs?: Array<{ question: string; answer: string }>;
  breadcrumbs?: Array<{ '@type': 'ListItem'; position: number; name: string; item?: string }>;
  reviews?: Array<{ rating: number }>;
  heroImage?: string;
  heroType?: string;
}

const { title, pageType, service, faqs, breadcrumbs, reviews, heroImage, heroType } = Astro.props;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content="Professional mobile diesel repair services for Phoenix Metro area. 24/7 emergency roadside assistance, fleet services, and commercial vehicle repairs." />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />
    <title>{title}</title>

    <!-- LCP Preload for hero images -->
    <LCPPreload heroPath={heroImage} heroType={heroType} />

    <UnifiedSchema
      pageType={pageType}
      service={service}
      faqs={faqs}
      breadcrumbs={breadcrumbs}
      reviews={reviews}
    />
  </head>
  <body class="min-h-screen bg-background text-foreground font-sans">
    <slot />

    <!-- Defer non-critical JavaScript for better performance -->
    <DeferNonCritical scripts={[
      { src: '/js/navigation.js', on: 'idle' },
      { src: '/js/forms.js', on: 'visible', selector: '#contact' }
    ]} />
  </body>
</html>