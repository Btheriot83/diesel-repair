---
const steps = [
  {
    number: "1",
    title: "Emergency Call & Assessment",
    description: "Call (480) 307-7434 for immediate dispatch or use our online request form. Our experienced dispatchers gather critical details: exact location (mile marker, cross streets), symptoms, truck specifications, and fault codes if available. We provide realistic ETAs based on Phoenix traffic patterns and coordinate with DPS for safe highway positioning when needed.",
    details: "Available 24/7 across Phoenix Metro including I-10, I-17, and all Loop highways.",
    icon: "phone"
  },
  {
    number: "2",
    title: "Mobile Tech Deployment",
    description: "Our certified diesel technicians are strategically positioned throughout the Valley for rapid response. We dispatch the nearest qualified mechanic with specialized diagnostic equipment and common repair parts. For complex issues, we pre-coordinate with local parts suppliers to minimize your downtime.",
    details: "Target response time: 60-90 minutes depending on location and traffic conditions. Pre-coordinated with local parts suppliers for complex repairs.",
    icon: "mappin"
  },
  {
    number: "3",
    title: "On-Site Diagnosis & Repair",
    description: "Our mobile unit arrives fully equipped with diagnostic computers, air compressors, welding equipment, and extensive parts inventory. Most repairs are completed on-site, getting you back on the road quickly. For major work requiring shop facilities, we coordinate towing to trusted Phoenix-area diesel shops and provide transparent repair estimates.",
    details: "Licensed, insured, and experienced with all major diesel engine brands and fleet specifications.",
    icon: "wrench"
  }
];

const getIcon = (iconType: string) => {
  switch (iconType) {
    case 'phone':
      return `<svg class="w-10 h-10 text-primary-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
              </svg>`;
    case 'mappin':
      return `<svg class="w-10 h-10 text-primary-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
              </svg>`;
    case 'wrench':
      return `<svg class="w-10 h-10 text-primary-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4"></path>
              </svg>`;
    default:
      return '';
  }
};
---

<section class="py-16 bg-gradient-to-br from-accent/5 to-primary/5">
  <div class="container mx-auto px-4">
    <div class="text-center mb-12">
      <h2 class="text-4xl md:text-5xl font-bold text-foreground mb-6">
        How It Works
      </h2>
      <p class="text-xl text-muted-foreground max-w-2xl mx-auto">
        Getting Your Truck Back on the Road Is Simple With Our Streamlined Process
      </p>
    </div>

    <div class="grid md:grid-cols-3 gap-8 max-w-6xl mx-auto mb-12" style="grid-template-rows: repeat(1, 1fr)">
      {steps.map((step, index) => (
        <div key={index} class="text-center group bg-white rounded-xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 flex flex-col h-full">
          <div class="flex items-center justify-center gap-4 mb-6">
            <div class="w-8 h-8 bg-accent rounded-full flex items-center justify-center text-white font-bold text-sm border-2 border-black">
              {step.number}
            </div>
            <div class="w-20 h-20 bg-primary rounded-full flex items-center justify-center shadow-lg group-hover:shadow-xl transition-all duration-300">
              <Fragment set:html={getIcon(step.icon)} />
            </div>
          </div>
          <h3 class="text-xl font-bold text-foreground mb-4">
            {step.title}
          </h3>
          <div class="flex-1 flex flex-col">
            <p class="text-muted-foreground leading-relaxed text-sm mb-4 flex-grow">
              {step.description}
            </p>
            <div class="bg-accent/10 rounded-lg p-3 mt-auto">
              <p class="text-xs text-accent font-semibold">
                {step.details}
              </p>
            </div>
          </div>
        </div>
      ))}
    </div>

    <div class="text-center">
      <p class="text-sm text-muted-foreground italic">
        Photos or Fault Codes Help Us Bring the Right Parts the First Time.
      </p>
    </div>
  </div>
</section>

<style>
  /* Ensure colors match CSS variables */
  .text-foreground {
    color: hsl(var(--foreground));
  }

  .text-muted-foreground {
    color: hsl(var(--muted-foreground));
  }

  .bg-primary {
    background-color: hsl(var(--primary));
  }

  .text-primary-foreground {
    color: hsl(var(--primary-foreground));
  }

  .bg-accent {
    background-color: hsl(var(--accent));
  }

  .text-accent {
    color: hsl(var(--accent));
  }

  .bg-accent\/10 {
    background-color: hsl(var(--accent) / 0.1);
  }

  .from-accent\/5 {
    --tw-gradient-from: hsl(var(--accent) / 0.05);
  }

  .to-primary\/5 {
    --tw-gradient-to: hsl(var(--primary) / 0.05);
  }
</style>